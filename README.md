# ğŸ“ æ ¡å›­æ—…æ¸¸ä¸æ—¥è®°åˆ†äº«ç³»ç»Ÿ (Campus Tourism & Diary System)

> **åŸºäº DeepSeek å¤§æ¨¡å‹çš„ä¸ªæ€§åŒ–æ—…æ¸¸å¯¼è§ˆä¸ç¤¾äº¤å¹³å°** > _Data Structure Course Design | Powered by FastAPI & DeepSeek V3_

![Python](https://img.shields.io/badge/Python-3.12%2B-blue)
![FastAPI](https://img.shields.io/badge/FastAPI-0.109%2B-009688)
![DeepSeek](https://img.shields.io/badge/AI-DeepSeek%20V3-purple)
![RAG](https://img.shields.io/badge/Tech-RAG%20Agent-orange)

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªé›†æˆäº†**ç”Ÿæˆå¼ AI**ã€**å¤šç»´æ¨èç®—æ³•**ä¸**ç¤¾äº¤äº’åŠ¨**åŠŸèƒ½çš„æ ¡å›­æ—…æ¸¸ç³»ç»Ÿã€‚æ ¸å¿ƒäº®ç‚¹åœ¨äºåˆ©ç”¨ **RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ)** æŠ€æœ¯ï¼Œè®© AI èƒ½å¤ŸåŸºäºç§æœ‰çš„æ—¥è®°æ•°æ®åº“å›ç­”ç”¨æˆ·é—®é¢˜ï¼ŒåŒæ—¶å…·å¤‡æ—¥è®°çƒ­åº¦ç»Ÿè®¡ã€åŠ¨æ€è¯„åˆ†æ¨èã€å¤šåª’ä½“åˆ†äº«ç­‰å®Œæ•´ä¸šåŠ¡é—­ç¯ã€‚

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½äº®ç‚¹ (Key Features)

### 0. ğŸ—ºï¸ æ²‰æµ¸å¼æ‹ŸçœŸå¯¼èˆª (Immersive Navigation)
- **åƒç´ çº§å¯è§†åŒ–**ï¼šä¸åŒäºä¼ ç»Ÿçš„åœ°å›¾ APIï¼Œæœ¬é¡¹ç›®é‡‡ç”¨**è‡ªå®šä¹‰åƒç´ åæ ‡ç³»**ã€‚å¯¼èˆªè·¯çº¿ç›´æ¥ç»˜åˆ¶åœ¨ç²¾ç¾çš„æ ¡å›­æ‰‹ç»˜å›¾ä¸Šï¼Œæä¾›æ²‰æµ¸å¼çš„è§†è§‰ä½“éªŒã€‚
- **æ™ºèƒ½è·¯å¾„è§„åˆ’**ï¼š
    - å†…ç½® **Dijkstra** ä¸ **å¤šç‚¹è§„åˆ’ç®—æ³•**ï¼Œæ— è®ºæ˜¯ä» A åˆ° Bï¼Œè¿˜æ˜¯é¡ºè·¯å»æ‹¿ä¸ªå¿«é€’ï¼Œéƒ½èƒ½è§„åˆ’å‡ºæœ€ä¼˜è·¯çº¿ã€‚
    - æ”¯æŒ **æ¨¡ç³Šæœç´¢ (Fuzzy Search)**ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒè¾“é”™åœ°åæ‰¾ä¸åˆ°è·¯ã€‚
- **å¼€å‘è€…å‹å¥½çš„å·¥å…·é“¾**ï¼šå†…ç½® HTML5 åœ°å›¾æ„å»ºå™¨ï¼Œæ— éœ€ä¸“ä¸š GIS çŸ¥è¯†ï¼Œç‚¹ç‚¹é¼ æ ‡å³å¯ç»˜åˆ¶å±äºä½ è‡ªå·±çš„æ ¡å›­è·¯ç½‘ã€‚

### 1. ğŸ§  AI æ™ºèƒ½å¯¼æ¸¸ (AI Agent & RAG)
- **DeepSeek å¤§æ¨¡å‹æ¥å…¥**ï¼šé›†æˆ DeepSeek V3/V3.2 æ¥å£ï¼Œå®ç°è‡ªç„¶è¯­è¨€æ™ºèƒ½å¯¹è¯ã€‚
- **RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ)**ï¼š
    - å®ç°äº†åŸºäºç§æœ‰æ•°æ®åº“çš„ **RAG Agent**ã€‚
    - ğŸ¤– **æ„å›¾è¯†åˆ«**ï¼šè‡ªåŠ¨åˆ†æç”¨æˆ·æé—®ï¼Œæå–æ ¸å¿ƒå…³é”®è¯ï¼ˆå¦‚â€œé£Ÿå ‚â€ã€â€œé“¶æâ€ï¼‰ã€‚
    - ğŸ“š **çŸ¥è¯†åº“é—®ç­”**ï¼šè‡ªåŠ¨æ£€ç´¢æ•°æ®åº“ä¸­çš„çœŸå®æ—¥è®°æ•°æ®ï¼Œç»“åˆä¸Šä¸‹æ–‡å›ç­”ç”¨æˆ·æé—®ï¼ˆå¦‚â€œæ ¹æ®å¤§å®¶åé¦ˆï¼Œå­¦ä¸€é£Ÿå ‚å¥½åƒå—ï¼Ÿâ€ï¼‰ã€‚
- **âœï¸ æ—¥è®°æ¶¦è‰²**ï¼šåˆ©ç”¨ LLM çš„æ–‡å­¦èƒ½åŠ›ï¼Œä¸€é”®ç¾åŒ–ç”¨æˆ·çš„æ—¥è®°è‰ç¨¿ï¼Œæå‡å†…å®¹è´¨é‡ã€‚

### 2. ğŸ”¥ åŠ¨æ€æ¨èä¸æ’åº (Recommendation Engine)
- **çƒ­åº¦ç³»ç»Ÿ (Hotness)**ï¼š
    - æ•°æ®åº“çº§åŸå­åŒ–æ›´æ–°ï¼Œç”¨æˆ·è®¿é—®è¯¦æƒ…é¡µè‡ªåŠ¨å¢åŠ æµè§ˆé‡ (`view_count`)ã€‚
- **å¤šç»´æ’åºç®—æ³•**ï¼š
    - **ğŸ”¥ çƒ­åº¦ä¼˜å…ˆ**ï¼šåŸºäºæµè§ˆé‡çš„é™åºæ’åºç®—æ³•ã€‚
    - **â­ è¯„åˆ†ä¼˜å…ˆ**ï¼šåŸºäºç”¨æˆ·åŠ æƒå¹³å‡åˆ†çš„æ’åºç®—æ³•ã€‚
    - **ğŸ•’ æ—¶é—´å€’åº**ï¼šå±•ç¤ºæœ€æ–°å‘å¸ƒçš„åŠ¨æ€ã€‚
- **å…¨ç«™æ£€ç´¢**ï¼šæ”¯æŒ `OR` é€»è¾‘çš„å…¨æ–‡æ¨¡ç³Šæ£€ç´¢ï¼Œå¯åŒæ—¶åŒ¹é…æ ‡é¢˜ä¸å†…å®¹ã€‚

### 3. ğŸ’¬ ç¤¾äº¤ä¸å¤šåª’ä½“ (Social & Multimedia)
- **åŠ¨æ€è¯„åˆ†**ï¼šæ‘’å¼ƒä½œè€…è‡ªè¯„ï¼Œé‡‡ç”¨**ç”¨æˆ·è¯„è®ºåŠ æƒå¹³å‡ç®—æ³•**ï¼Œå®æ—¶æ›´æ–°æ—¥è®°å¾—åˆ†ã€‚
- **æ–‡ä»¶æœåŠ¡**ï¼šæ”¯æŒå›¾ç‰‡/è§†é¢‘ä¸Šä¼ ï¼Œé…ç½®é™æ€èµ„æºæŒ‚è½½ï¼Œå®ç°åª’ä½“èµ„æºçš„ç›´æ¥è®¿é—®ã€‚

---

## ğŸ”Œ API æ¥å£æ¦‚è§ˆ

| æ¨¡å— | æ–¹æ³• | è·¯å¾„ | æè¿° |
| :--- | :--- | :--- | :--- |
| **ğŸ¤– AI æ™ºèƒ½** | `POST` | `/ai/rag_chat` | **AI æ™ºèƒ½é—®ç­”** (é›†æˆ RAG æŸ¥åº“åŠŸèƒ½) |
| | `POST` | `/ai/polish` | **AI æ—¥è®°æ¶¦è‰²** (ç¾åŒ–æ–‡æœ¬) |
| **ğŸ“’ æ—¥è®°ç®¡ç†** | `GET` | `/diaries/search` | **å…¨ç«™æœç´¢** (æ”¯æŒ `sort_by=heat/score`) |
| | `POST` | `/diaries/comment` | **å‘è¡¨è¯„è®º** (è§¦å‘è‡ªåŠ¨ç®—åˆ†é€»è¾‘) |
| | `GET` | `/diaries/{id}/comments`| **è·å–è¯„è®ºåˆ—è¡¨** |
| **ğŸ“· æ–‡ä»¶æœåŠ¡** | `POST` | `/upload` | **ä¸Šä¼ å›¾ç‰‡/è§†é¢‘** (è¿”å›é™æ€ URL) |

---

## ğŸ“‚ é¡¹ç›®ç»“æ„å˜åŠ¨ (File Structure Changes)

æœ¬æ¬¡æ›´æ–°æ¶‰åŠçš„æ ¸å¿ƒæ–‡ä»¶ä¿®æ”¹å¦‚ä¸‹ï¼š

- `src/models.py`: 
    - âœ¨ æ–°å¢ `Comment` è¡¨ã€‚
    - ğŸ”§ ä¿®æ”¹ `Diary` è¡¨ (å¢åŠ  `view_count`, `media_json`, `score` å­—æ®µ)ã€‚
- `src/diary.py`: 
    - ğŸ”„ é‡æ„å‘å¸ƒæ¥å£ã€‚
    - âœ¨ æ–°å¢ `add_comment` (è¯„è®ºå¹¶ç®—åˆ†) ä¸ `search_diaries` (æœç´¢ä¸æ’åº) æ¥å£ã€‚
- `src/ai.py` **[NEW]**: 
    - ğŸ¤– æ–°å¢ AI æ ¸å¿ƒæ¨¡å—ï¼Œå°è£… Chatã€Polish å’Œ RAG æ£€ç´¢é€»è¾‘ã€‚
- `src/upload.py` **[NEW]**: 
    - ğŸ“· æ–°å¢æ–‡ä»¶ä¸Šä¼ å¤„ç†é€»è¾‘ã€‚
- `src/api.py`: 
    - ğŸ”Œ æ³¨å†Œ AI å’Œ Upload è·¯ç”±ã€‚
    - ğŸŒ å¢åŠ é™æ€æ–‡ä»¶æŒ‚è½½ (`Mount StaticFiles`)ã€‚

---

## ğŸ“… æ›´æ–°æ—¥å¿— (Update Log) - 2026/1/18
### ğŸ•’ 22:20 - v2.3 æ­£å¼ç‰ˆï¼šæ‹ŸçœŸè·¯çº¿ä¸å¯è§†åŒ–å¯¼èˆª
- **[Map] è‡ªç ”åƒç´ çº§åœ°å›¾å¼•æ“**ï¼š
    - æ‘’å¼ƒæŠ½è±¡ç»çº¬åº¦ï¼ŒåŸºäºçœŸå®æ ¡å›­å¹³é¢å›¾ (`map.png`) æ„å»º `(x, y)` åƒç´ åæ ‡ç³»ï¼Œå®ç°â€œæ‰€è§å³æ‰€å¾—â€çš„ç²¾å‡†å®šä½ã€‚
    - é…å¥—å¼€å‘ **å¯è§†åŒ–æ‰“ç‚¹å·¥å…· (`map_tool.html`)**ï¼Œæ”¯æŒé¼ æ ‡ç‚¹å‡»å¿«é€Ÿç”Ÿæˆè·¯ç½‘ JSON æ•°æ®ï¼Œæ”¯æŒæ’¤é”€ã€æ”¹åä¸é—­ç¯è¿æ¥ã€‚
- **[Nav] å¯è§†åŒ–è·¯å¾„è§„åˆ’**ï¼š
    - åç«¯æ¥å£ `/navigate` å‡çº§ï¼Œæ–°å¢è¿”å› `path_coords` (åƒç´ åæ ‡ç‚¹é›†)ã€‚
    - å‰ç«¯æ”¯æŒåœ¨åœ°å›¾å›¾ç‰‡ä¸Šé€šè¿‡ SVG/Canvas åŠ¨æ€ç»˜åˆ¶å¯¼èˆªçº¢çº¿ï¼Œç›´è§‚å±•ç¤ºè¡Œèµ°è·¯çº¿ã€‚
- **[Algo] é«˜çº§ç®—æ³•é›†æˆ**ï¼š
    - **å¤šç‚¹é€”ç»è§„åˆ’**ï¼šæ”¯æŒâ€œè¥¿é—¨ -> å›¾ä¹¦é¦† -> é£Ÿå ‚â€çš„ TSP (æ—…è¡Œå•†é—®é¢˜) è¿‘ä¼¼è·¯å¾„è§„åˆ’ã€‚
    - **æ¨¡ç³Šåœ°ç‚¹æœç´¢**ï¼šé›†æˆ `thefuzz` åº“ï¼Œæ”¯æŒâ€œå­¦ä¸€â€è‡ªåŠ¨åŒ¹é…â€œå­¦ä¸€é£Ÿå ‚â€å¹¶å®šä½ã€‚
    - **å¤šç­–ç•¥å¯¼èˆª**ï¼šæ”¯æŒ **æ­¥è¡Œ (æœ€çŸ­è·ç¦»)** ä¸ **è‡ªè¡Œè½¦ (æœ€çŸ­æ—¶é—´)** ä¸¤ç§æƒé‡ç­–ç•¥åˆ‡æ¢ã€‚

### ğŸ› ï¸ è¶…çº§æµ‹è¯•å·¥å…·ç®±
ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…è°ƒè¯•ï¼Œé¡¹ç›®å†…ç½®äº†äº¤äº’å¼æµ‹è¯•å¥—ä»¶ã€‚
- **å¯åŠ¨æ–¹å¼**: 
  ```bash
  uv run run_tests.py

### ğŸ•’ 16:30 - v2.1 æ­£å¼ç‰ˆï¼šAI æ·±åº¦é›†æˆ
- **[Feature]** RAG Agent ä¸Šçº¿ï¼šAI ç°å·²æ”¯æŒè¯»å–ç§æœ‰æ•°æ®åº“å†…å®¹å›ç­”é—®é¢˜ã€‚
- **[Feature]** æ„å›¾è¯†åˆ«ä¼˜åŒ–ï¼šAI å¯ç²¾å‡†æå–æœç´¢å…³é”®è¯ã€‚
- **[Feature]** æ—¥è®°æ¶¦è‰²åŠŸèƒ½ä¸Šçº¿ã€‚

### ğŸ•’ 15:50 - v2.1 ä¿®å¤ç‰ˆï¼šç®—æ³•ä¿®æ­£
- **[Fix]** ä¿®å¤è¯„åˆ†ç®—æ³•ï¼šä¼˜åŒ–äº†å¹³å‡åˆ†è®¡ç®—é€»è¾‘ï¼Œç°åœ¨å‘å¸ƒæ—¥è®°åŠè¯„è®ºåçš„å¾—åˆ†æ˜¾ç¤ºæ­£å¸¸ã€‚
- **[Model]** æ¨¡å‹å‡çº§ï¼š`ai.py` æ¥å…¥ DeepSeek-v3.2 æ¨¡å‹ã€‚

### ğŸ•’ 15:00 - v2.0 å¤§ç‰ˆæœ¬ï¼šæ ¸å¿ƒä¸šåŠ¡ä¸Šçº¿
- **[Core]** æ—¥è®°çƒ­åº¦ç³»ç»Ÿä¸Šçº¿ (View Count)ã€‚
- **[Core]** æ¨èç®—æ³•å®è£… (Heat/Score/Time Sorting)ã€‚
- **[Search]** å…¨æ–‡æ£€ç´¢å¼•æ“ä¸Šçº¿ã€‚
- **[Media]** å›¾ç‰‡/è§†é¢‘ä¸Šä¼ ä¸é™æ€èµ„æºæ‰˜ç®¡å®Œæˆã€‚
- **[System]** å¢åŠ  `lifespan` è‡ªåŠ¨æ•°æ®åº“è¡¨ç»“æ„æ£€æµ‹ä¸ä¿®å¤ã€‚

---

> **å¿«é€Ÿå¼€å§‹**: è¯·ç¡®ä¿åœ¨ `src/ai.py` ä¸­å¡«å…¥æœ‰æ•ˆçš„ DeepSeek API Keyï¼Œå¹¶è¿è¡Œ `uv run uvicorn src.api:app --reload` å¯åŠ¨æœåŠ¡ã€‚
